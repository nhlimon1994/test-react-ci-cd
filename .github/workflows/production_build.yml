name: Production Deployment
on:
  push:
    branches: [ master ]
jobs:
  deploy:
    runs-on: ubuntu-22.04
    steps:
      - name: Deploy app to Development Server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ vars.DEV_SSH_HOST }}
          username: ${{ secrets.DO_USERNAME }}
          password: ${{ secrets.DO_PASSWORD }}
          sync: true
          script: |
            set -e
            echo "Deploying application ..."
            cd ${{ vars.DEV_HOST_PATH }}
            git switch master
            git checkout .
            git pull origin master --force
            npm install
            npm run build
            echo "Application deployed successfully!"
